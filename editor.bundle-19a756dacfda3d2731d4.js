"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[189],{879:(e,t,i)=>{i.d(t,{tG:()=>l,Im:()=>o,jb:()=>c,K_:()=>m,yj:()=>d,fq:()=>u,j8:()=>g,Xc:()=>p,oW:()=>f,lk:()=>h,jX:()=>v,w:()=>b,YF:()=>y});var r=i(51),a=i(485);const s=e=>{e.createdAt=new Date(e.createdAt),e.updatedAt=new Date(e.updatedAt)},n=e=>(e.articles.forEach(s),e),l=({offset:e,limit:t})=>(0,r.U2)("articles",{offset:e,limit:t}).then(a.Q).then(n),o=({offset:e,limit:t})=>(0,r.U2)("articles/feed",{offset:e,limit:t}).then(a.Q).then(n),c=({tag:e,offset:t,limit:i})=>(0,r.U2)("articles",{tag:e,offset:t,limit:i}).then(a.Q).then(n),m=({author:e,limit:t,offset:i})=>(0,r.U2)("articles",{author:e,offset:i,limit:t}).then(a.Q).then(n),d=({favorited:e,limit:t,offset:i})=>(0,r.U2)("articles",{favorited:e,offset:i,limit:t}).then(a.Q).then(n),u=({slug:e})=>(0,r.U2)(`articles/${encodeURIComponent(e)}`).then(a.Q).then((({article:e})=>(s(e),{article:e}))),g=({title:e,description:t,body:i,tagList:s})=>(0,r.v_)("articles",{article:{title:e,description:t,body:i,tagList:s}}).then(a.Q,a.l),p=({slug:e,title:t,description:i,body:s,tagList:n})=>(0,r.gz)(`articles/${encodeURIComponent(e)}`,{article:{title:t,description:i,body:s,tagList:n}}).then(a.Q,a.l),f=({slug:e,isFavorite:t})=>(t?r.v_:r.IV)(`articles/${e}/favorite`).then(a.Q),h=({slug:e})=>(0,r.U2)(`articles/${encodeURIComponent(e)}/comments`).then(a.Q).then((({comments:e})=>(e.forEach(s),{comments:e}))),v=({slug:e})=>(0,r.IV)(`articles/${encodeURIComponent(e)}`),b=({slug:e,comment:t})=>(0,r.v_)(`articles/${encodeURIComponent(e)}/comments`,{comment:{body:t}}).then(a.Q).then((({comment:e})=>(s(e),{comment:e}))),y=({slug:e,commentId:t})=>(0,r.IV)(`articles/${encodeURIComponent(e)}/comments/${t}`)},707:(e,t,i)=>{i.d(t,{d:()=>a});var r=i(759);function a(e){const t={title:e.title,author:new r.n(e.author),description:e.description,body:e.body,slug:e.slug,createdAt:e.createdAt,updatedAt:e.updatedAt,favorited:e.favorited,favoritesCount:e.favoritesCount,tagList:e.tagList,comments:null,setFavorite:({favorited:e,favoritesCount:i})=>{t.favorited=e,t.favoritesCount=i},setComments:e=>{t.comments=e},addComment:e=>{t.comments.unshift(e)},deleteComment:e=>{const i=t.comments.findIndex((t=>t.id===e));-1!==i&&t.comments.splice(i,1)}};return t}},315:(e,t,i)=>{i.r(t),i.d(t,{default:()=>m});var r=i(395),a=i(386),s=i(875),n=i(96),l=i(759),o=i(707),c=i(879);const m=(0,r.Ih)((function(){const e={isNew:!1,form:null,serverErrors:null,article:null,onEnter:({routeFragment:i})=>l.a.isAuthenticated?(e.isNew=!i.abstractPath,e.isNew?void t():e.getArticle(n.Z.params.get("slug")).then(t,(()=>(n.Z.transitionTo("/"),!1)))):(n.Z.transitionTo("/login"),!1)},t=()=>{e.form=new a.Z({children:[{name:"title",initialValue:e.article&&e.article.title,validate:(0,s.C1)()},{name:"description",initialValue:e.article&&e.article.description},{name:"body",initialValue:e.article&&e.article.body,validate:(0,s.C1)()},{name:"tagString",actions:{submit:e.updateTagList}},{name:"tagList",initialValue:e.article&&e.article.tagList||[]}],actions:{submit:()=>{const t=e.form.getResult();e.saveArticle({title:t.title,description:t.description,body:t.body,tagList:t.tagList})}},onFormChange:()=>{e.serverErrors=null}})};return e.getArticle=t=>c.fq({slug:t}).then((({article:t})=>{e.article=new o.d(t)})),e.saveArticle=({title:t,description:i,body:r,tagList:a})=>(e.serverErrors=null,(e.isNew?c.j8({title:t,description:i,body:r,tagList:a}):c.Xc({slug:e.article.slug,title:t,description:i,body:r,tagList:a})).then((({article:{slug:e}})=>{n.Z.transitionTo(`/article/${e}`)}),(t=>{e.serverErrors=t}))),e.updateTagList=()=>{const t=e.form.get("tagList"),i=t.getValue(),r=e.form.get("tagString"),a=r.getResult(),s=a&&a.split(",").map((e=>e.trim())).filter((e=>e&&!i.includes(e)));r.clear(),s&&s.length&&t.onChange(i.concat(s))},e.removeTag=t=>{e.form.get("tagList").getValue().splice(t,1)},e}))},86:(e,t,i)=>{i.r(t),i.d(t,{default:()=>c});var r=i(408),a=i(294),s=i(697),n=i.n(s),l=i(898);function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}class c extends r.Component{constructor(){super(),this.onSubmit=e=>{e.preventDefault(),this.props.controller.form.submit()},this.onTagStringKeyPress=e=>{"Enter"===e.key&&(e.preventDefault(),this.props.controller.form.get("tagString").submit())}}render(){const{form:e,serverErrors:t,isPending:i,removeTag:r}=this.props.controller,s=e.get("tagList").getValue();return a.createElement("div",{className:"editor-page"},a.createElement("div",{className:"container page"},a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-10 offset-md-1 col-xs-12"},t&&a.createElement("ul",{className:"error-messages"},t.map(((e,t)=>a.createElement("li",{key:t},e)))),a.createElement("form",{onSubmit:this.onSubmit},a.createElement("fieldset",null,a.createElement("fieldset",{className:"form-group"},a.createElement(l.Z,o({type:"text",inputClassName:"form-control form-control-lg",placeholder:"Article Title",disabled:i},e.get("title")))),a.createElement("fieldset",{className:"form-group"},a.createElement(l.Z,o({type:"text",inputClassName:"form-control",placeholder:"What's this article about?",disabled:i},e.get("description")))),a.createElement("fieldset",{className:"form-group"},a.createElement(l.Z,o({type:"textarea",inputClassName:"form-control",placeholder:"Write your article (in markdown)",inputProps:{rows:"8"},disabled:i},e.get("body")))),a.createElement("fieldset",{className:"form-group"},a.createElement(l.Z,o({type:"text",inputClassName:"form-control",placeholder:"Enter tags",disabled:i},e.get("tagString"),{inputProps:{onKeyPress:this.onTagStringKeyPress}})),!!s.length&&a.createElement("div",{className:"tag-list"},s.map(((e,t)=>a.createElement("span",{key:t,className:"tag-default tag-pill"},a.createElement("i",{className:"ion-close-round",onClick:r.bind(null,t)}),e))))),a.createElement("button",{className:"btn btn-lg pull-xs-right btn-primary",disabled:i},"Publish Article")))))))}}c.propTypes={controller:n().object.isRequired}}}]);
//# sourceMappingURL=editor.bundle-19a756dacfda3d2731d4.js.map